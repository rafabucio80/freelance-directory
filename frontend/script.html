<script>
  document.addEventListener('DOMContentLoaded', () => {
    google.script.run.withSuccessHandler(showFreelancers).getFreelancers();
  });

  function showFreelancers(data) {
    const container = document.getElementById('freelancers-container');
    data.forEach(freelancer => {
      container.innerHTML += `
        <div class="freelancer-card ${freelancer.premium ? 'premium' : ''}">
          <img src="${freelancer.foto}" class="profile-img">
          <h3>${freelancer.nombre} ${freelancer.premium ? '⭐' : ''}</h3>
          <p>${freelancer.pais}</p>
          <div class="skills">
            ${[...freelancer.habilidades, ...freelancer.lenguajes].map(skill => `
              <span class="badge">${skill.trim()}</span>
            `).join('')}
          </div>
          <a href="${freelancer.cv}" target="_blank" class="cv-button">Descargar CV</a>
        </div>
      `;
    });
  }

  function openModal(freelancerData) {
  const modal = document.getElementById('freelancer-modal');
  const modalContent = document.getElementById('modal-content');
  
  modalContent.innerHTML = `
    <div class="modal-header">
      <span class="close-modal" onclick="closeModal()">&times;</span>
      <h2>${freelancerData.nombre}</h2>
    </div>
    <div class="modal-body">
      <img src="${freelancerData.foto}" class="modal-profile-img">
      <p><strong>País:</strong> ${freelancerData.pais}</p>
      <div class="skills">
        ${freelancerData.skills.map(skill => `<span class="badge">${skill}</span>`).join('')}
      </div>
      ${freelancerData.premium ? `<a href="${freelancerData.cvUrl}" target="_blank" class="cv-button">Descargar CV</a>` : ''}
    </div>
  `;
  modal.style.display = 'block';
}

function closeModal() {
  document.getElementById('freelancer-modal').style.display = 'none';
}

document.addEventListener('DOMContentLoaded', () => {
  google.script.run.withSuccessHandler((data) => {
    const container = document.getElementById('freelancers-container');
    container.innerHTML = '';
    
    data.forEach(freelancer => {
      container.innerHTML += `
        <div class="freelancer-card">
          <img src="${freelancer.foto}" class="profile-img">
          <h3>${freelancer.nombre}</h3>
          <p class="freelancer-title">${freelancer.titulo || 'Sin título especificado'}</p>
          <div class="skills">
            ${freelancer.skills.map(skill => `<span class="badge">${skill.trim()}</span>`).join('')}
          </div>
          <button class="view-more-btn ${freelancer.premium ? '' : 'disabled'}" 
                  onclick="${freelancer.premium ? `openModal(${JSON.stringify(freelancer).replace(/"/g, '&quot;')})` : 'return false'}">
            ${freelancer.premium ? 'Ver más' : 'No disponible'}
          </button>
        </div>
      `;
    });
  }).getFreelancers();
});
</script>
